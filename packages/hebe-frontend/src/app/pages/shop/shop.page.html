<!-- <ion-split-pane  contentId="main-content"> -->
<ion-header #header class="ion-no-border">
  <app-navbar></app-navbar>
</ion-header>
<ion-content>
  <!-- margin-top: 0.1%; -->
  <ion-split-pane when="sm" contentId="main-content">
    <ion-menu contentId="main-content" type="push" class="menu">
      <ion-content>
        <ion-list id="inbox-list" class="list">
          <ion-list-header>
            <ion-searchbar
              class="searchbar"
              #query
              animated
              placeholder="Search Product"
              [autocorrect]="true"
              [spellcheck]="true"
              type="search"
              (keyup.enter)="search(query.value)"
            >
            </ion-searchbar>
          </ion-list-header>
          <ion-title style="margin-top: 10%; font-size: large"
            >Filter By Price</ion-title
          >
          <ion-range
            class="range"
            [dualKnobs]="true"
            [value]="{ lower: 300, upper: 10000} "
            (ionChange)="range($event)"
            [min]="300"
            [max]="10000"
          ></ion-range>
          <div class="pricerange">
            <ion-button
              shape="round"
              type="submit"
              (click)="search(query.value)"
              >Search</ion-button
            >
            <ion-label
              >Price: {{ min | currency: "INR":"symbol":"2.0"}} â€” {{ max |
              currency: "INR":"symbol":"2.0"}}</ion-label
            >
          </div>
          <ion-title class="filterBy">Filter by</ion-title>
          <ion-accordion-group expand="inset">
            <ion-accordion>
              <ion-item slot="header">
                <ion-label>Categories</ion-label>
              </ion-item>
              <ion-list slot="content">
                <ion-menu-toggle
                  auto-hide="false"
                  *ngFor="let category of categories"
                >
                  <ion-item
                    style="margin-left: 5%; margin-right: 5%"
                    class="categorynames"
                    (click)="search(category)"
                    lines="none"
                    button
                    shape="round"
                    detail="false"
                  >
                    <ion-label> {{ category | titlecase}} </ion-label>
                  </ion-item>
                </ion-menu-toggle>
              </ion-list>
            </ion-accordion>
            <ion-accordion>
              <ion-item slot="header">
                <ion-label>Brands</ion-label>
              </ion-item>
              <ion-list slot="content">
                <ion-menu-toggle auto-hide="false" *ngFor="let brand of brands">
                  <ion-item
                    style="margin-left: 5%; margin-right: 5%"
                    class="categorynames"
                    (click)="search(brand)"
                    lines="none"
                    button
                    shape="round"
                    detail="false"
                  >
                    <ion-label> {{ brand | titlecase}} </ion-label>
                  </ion-item>
                </ion-menu-toggle>
              </ion-list>
            </ion-accordion>
          </ion-accordion-group>
        </ion-list>
      </ion-content>
    </ion-menu>

    <div class="ion-page" id="main-content">
      <ion-header class="ion-no-border">
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-menu-toggle>
              <ion-button>
                <ion-icon slot="icon-only" name="menu"></ion-icon>
              </ion-button>
            </ion-menu-toggle>
            <!-- <ion-buttons slot="start"> -->
            <ion-back-button
              defaultHref="home"
              routerDirection="back"
            ></ion-back-button>
            <!-- </ion-buttons> -->
          </ion-buttons>
          <ion-label size="small"
            >Showing all {{this.totalresults}} results of {{count}}
          </ion-label>
          <ion-item slot="end" class="dropdown">
            <ion-select
              interface="popover"
              placeholder="Sort by"
              (ionChange)="localSort($event)"
            >
              <ion-select-option value="latest"
                >Sort by latest</ion-select-option
              >
              <ion-select-option value="asc"
                >Sort by price: low to high</ion-select-option
              >
              <ion-select-option value="desc"
                >Sort by price: high to low</ion-select-option
              >
            </ion-select>
          </ion-item>
        </ion-toolbar>
      </ion-header>
      <ion-content scrollEvents="true" [appHideHeader]="header">
        <ion-spinner *ngIf="spinner" name="lines-small"></ion-spinner>
        <ion-grid *ngIf="!spinner" class="grid">
          <ion-row class="ion-justify-content-center ion-align-items-center">
            <ion-col size-lg="5" size-xs="12" class="ion-text-center">
              <h1 id="product" [hidden]="hidden">No products available</h1>
            </ion-col>
          </ion-row>
          <ion-row>
            <!-- <ion-img class="img-wrapper" [src]="product.productImg"  alt="Image not availabel"></ion-img> -->
            <ion-col
              sizeLg="4"
              sizeMd="4"
              sizeXs="12"
              style="width: 100%; min-width: 230px"
              *ngFor="let product of products"
            >
              <ion-card
                [routerLink]='"/product/"+product.id'
                routerLinkActive="selected"
                class="card"
              >
                <ion-img
                  class="cropped-image fill-image"
                  [src]="product.productImg"
                  alt="Image not availabel"
                ></ion-img>
                <ion-card-header style="padding-bottom: 3%">
                  <ion-label>
                    <!-- <ion-note class="brandName">{{product.brand.name }}</ion-note> -->
                    <ion-card-title class="ellipsis"
                      >{{product.productName}}</ion-card-title
                    >
                  </ion-label>
                </ion-card-header>
                <ion-card-content>
                  <h3 class="price">
                    {{product.productPrice | currency: "INR":"symbol":"2.0" }}
                  </h3>
                </ion-card-content>
              </ion-card>
            </ion-col>
          </ion-row>
          <ion-infinite-scroll
            threshold="100px"
            (ionInfinite)="loadData($event)"
            [disabled]="totalresults >= count"
          >
            <ion-infinite-scroll-content
              loadingSpinner="bubbles"
              loadingText="Loading more data..."
            >
            </ion-infinite-scroll-content>
          </ion-infinite-scroll>
        </ion-grid>
      </ion-content>
    </div>
  </ion-split-pane>
</ion-content>
